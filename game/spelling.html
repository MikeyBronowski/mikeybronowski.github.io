
<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Spelling Quest</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: sans-serif;
      margin:0;
      padding:0;
      background:#f2f2f2;
      display:flex;
      flex-direction:column;
      height:100vh;
    }
    header, footer {
      background:#333;
      color:white;
      text-align:center;
      padding:10px;
    }
    main {
      flex:1;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      padding:10px;
    }
    #emoji {
      font-size:64px;
      margin-bottom:10px;
    }
    #placeholders, #bank {
      display:flex;
      flex-wrap:wrap;
      justify-content:center;
      margin:10px 0;
      gap:6px;
    }
    .tile {
      width:clamp(28px, 7vw, 60px);
      height:clamp(28px, 7vw, 60px);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:clamp(18px, 4vw, 28px);
      border-radius:6px;
      user-select:none;
    }
    .tile.bank { background:#FFD700; cursor:pointer; }
    .tile.bank.used { background:#ccc; color:#666; }
    .tile.slot { background:#444; color:white; }
    .tile.slot.filled { background:#999; }
    .tile.slot.success { background:#4CAF50; }
    .tile.slot.fail { background:#F44336; }
    #controls { margin-top:10px; display:flex; gap:10px; }
    button { padding:8px 12px; border:none; border-radius:4px; cursor:pointer; }
    button.secondary { background:#ccc; }
    #hud { margin:10px; font-size:14px; }
    footer { font-size:12px; display:flex; justify-content:space-between; align-items:center; }
  </style>
</head>
<body>
  <header>
    <h1>Spelling Quest</h1>
    <div id="hud"></div>
  </header>
  <main>
    <div id="emoji">üçé</div>
    <div id="placeholders"></div>
    <div id="bank"></div>
    <div id="controls">
      <button id="btnUndo" class="secondary">‚Ü©Ô∏è Cofnij</button>
      <button id="btnClear" class="secondary">üßπ Wyczy≈õƒá</button>
    </div>
  </main>
  <footer>
    <span>Spelling Quest</span>
    <span id="wordCount">0/0</span>
  </footer>
<script>
const words = [
  {emoji:"üçé", word:"JAB≈ÅKO"},
  {emoji:"üçå", word:"BANAN"},
  {emoji:"üê∂", word:"PIES"},
  {emoji:"üê±", word:"KOT"},
  {emoji:"üß∏", word:"MI≈ö"},
  {emoji:"üö≤", word:"ROWER"},
  {emoji:"üè†", word:"DOM"},
  {emoji:"‚öΩ", word:"PI≈ÅKA"},
  {emoji:"üåà", word:"TƒòCZA"},
  {emoji:"üö§", word:"≈Å√ìDKA"},
  {emoji:"ü•ï", word:"MARCHEWKA"},
  {emoji:"ü•î", word:"ZIEMNIAK"},
  {emoji:"üçì", word:"TRUSKAWKA"},
  {emoji:"üçê", word:"GRUSZKA"},
  {emoji:"üçá", word:"WINOGRONO"},
  {emoji:"üçí", word:"WI≈öNIA"},
  {emoji:"üçâ", word:"ARBUZ"},
  {emoji:"üçç", word:"ANANAS"},
  {emoji:"üçë", word:"BRZOSKWINIA"},
  {emoji:"üçã", word:"CYTRYNA"}
];
let state = {
  current:null,
  typed:'',
  usedIndices:[],
  bankButtons:[],
  history:new Set()
};
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}
function nextWord(){
  if(state.history.size===words.length) state.history.clear();
  let choice;
  do { choice = words[Math.floor(Math.random()*words.length)]; }
  while(state.history.has(choice.word));
  state.history.add(choice.word);
  state.current=choice; state.typed=''; state.usedIndices=[]; state.bankButtons=[];
  document.getElementById('emoji').textContent=choice.emoji;
  renderPlaceholders();
  renderBank();
  updateHud();
}
function renderPlaceholders(){
  const ph = document.getElementById('placeholders');
  ph.innerHTML='';
  const w = state.current.word;
  for(let i=0;i<w.length;i++){
    const slot = document.createElement('div');
    slot.className='tile slot';
    if(i===0){ slot.textContent=w[0]; }
    else if(i<=state.typed.length){ slot.textContent=state.typed[i-1]; slot.classList.add('filled'); }
    ph.appendChild(slot);
  }
}
function renderBank(){
  const wrap=document.getElementById('bank'); wrap.innerHTML='';
  const w=state.current.word;
  state.bankButtons=[]; state.usedIndices=[];
  const letters=[...w]; shuffle(letters);
  let reserved=false;
  letters.forEach((ch,i)=>{
    const b=document.createElement('button');
    b.className='tile bank'; b.textContent=ch;
    if(!reserved && ch===w[0]){
      b.classList.add('used'); b.disabled=true; b.dataset.reserved='1'; reserved=true;
    } else {
      b.onclick=()=>{
        if(b.classList.contains('used'))return;
        b.classList.add('used'); b.disabled=true;
        const idx=state.bankButtons.indexOf(b); if(idx>=0) state.usedIndices.push(idx);
        state.typed+=ch; renderPlaceholders();
        if(state.typed.length===w.length-1){
          const full=w[0]+state.typed;
          if(full===w){ onCorrect(); } else { onWrong(); }
        }
      }
    }
    state.bankButtons.push(b); wrap.appendChild(b);
  });
}
function undoLetter(){
  if(state.usedIndices.length===0) return;
  const idx=state.usedIndices.pop();
  const btn=state.bankButtons[idx];
  if(btn && !btn.dataset.reserved){ btn.classList.remove('used'); btn.disabled=false; }
  state.typed=state.typed.slice(0,-1);
  renderPlaceholders();
}
function resetAttempt(){
  state.usedIndices.forEach(i=>{ const btn=state.bankButtons[i]; if(btn && !btn.dataset.reserved){ btn.classList.remove('used'); btn.disabled=false; }});
  state.usedIndices=[]; state.typed=''; renderPlaceholders();
}
function onCorrect(){
  document.querySelectorAll('#placeholders .tile').forEach((t,i)=>{ if(i>0) t.classList.add('success'); });
  speak(state.current.word);
  setTimeout(nextWord,800);
}
function onWrong(){
  document.querySelectorAll('#placeholders .tile').forEach((t,i)=>{ if(i>0) t.classList.add('fail'); });
  setTimeout(()=>{ resetAttempt(); },600);
}
function speak(txt){
  if('speechSynthesis' in window){
    const u=new SpeechSynthesisUtterance(txt); u.lang='pl-PL'; speechSynthesis.speak(u);
  }
}
function updateHud(){
  document.getElementById('wordCount').textContent= state.history.size + '/' + words.length;
}
document.getElementById('btnUndo').onclick=undoLetter;
document.getElementById('btnClear').onclick=resetAttempt;
nextWord();
</script>
</body>
</html>
